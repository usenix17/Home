<report>
	<sql>
		SELECT e.course, year(e.date) - if(month(e.date) &lt; 8, 1, 0) as contract_year, count(e.enrollment_id) as registrations, sum(if(e.status='Completed',1,0)) as certifications
		FROM enrollments e
		WHERE [course] AND [date_min] AND [date_max]
		GROUP BY year(e.date) - if(month(e.date) &lt; 8, 1, 0), e.course
		ORDER BY year(e.date) - if(month(e.date) &lt; 8, 1, 0) DESC, e.course
	</sql>

	<parameters>
		<param type='date' name='date_min'>
			<label>Start Date (inclusive)</label>
			<default>true</default>
			<sql>certification_time &gt;= [value]</sql>
		</param>
		<param type='date' name='date_max'>
			<label>End Date (non-inclusive)</label>
			<default>true</default>
			<sql>certification_time &lt; [value]</sql>
		</param>
	</parameters>

	<courses value='enrolled' name='course' field='course'/>
</report>
